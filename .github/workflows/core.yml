name: Core Tests
on: [push, pull_request]
permissions:
  contents: read

jobs:
  tests:
    name: Core Tests
    if: "!contains(github.event.head_commit.message, 'ci skip')"
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        protobuf: ['IwBQ', 'JAAw', 'JABA', 'JIBQ',]
        attempt: [1,2,3,4,5,6,7,8,9,'10',11,12,13,14,15,16,17,18,19,'20',21,22,23,24,25,26,27,28,29,'30',31,32,33,34,35,36,37,38,39,'40',41,42,43,44,45,46,47,48,49,'50',51,52,53,54,55,56,57,58,59,'60',61,62,63]
    steps:
    - uses: actions/checkout@v4
    - name: Run tests
      continue-on-error: False
      run: |
        sed -i 's/IIAQ/${{ matrix.protobuf }}/g' yt_dlp/extractor/youtube.py
        git diff
        python3 -Werror -m yt_dlp --simulate --extractor-args "youtube:player_client=android" --abort-on-error WNCl-69POro
